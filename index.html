<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grid Encryption/Decryption</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .panel {
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        textarea {
            width: 100%;
            min-height: 150px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: vertical;
            font-family: monospace;
        }
        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 8px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        .status {
            margin-top: 15px;
            padding: 10px;
            border-radius: 4px;
            display: none;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            display: block;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            display: block;
        }
        .grid-visualization {
            margin-top: 20px;
            overflow-x: auto;
        }
        table {
            border-collapse: collapse;
            margin: 10px 0;
        }
        td {
            border: 1px solid #ddd;
            width: 30px;
            height: 30px;
            text-align: center;
            vertical-align: middle;
        }
        .highlight {
            background-color: #ffeeba;
        }
    </style>
</head>
<body>
    <h1>Grid Encryption/Decryption System</h1>
    
    <div class="container">
        <div class="panel">
            <h2>Encryption</h2>
            <label for="plaintext">Plaintext:</label>
            <textarea id="plaintext" placeholder="Enter text to encrypt"></textarea>
            
            <label for="encryptionKey">Encryption Key:</label>
            <input type="text" id="encryptionKey" placeholder="Enter encryption key">
            
            <label for="gridSize">Grid Size (N x N):</label>
            <input type="number" id="gridSize" min="2" max="20" value="5">
            
            <button id="encryptBtn">Encrypt</button>
            <div id="encryptStatus" class="status"></div>
            
            <div class="grid-visualization">
                <h3>Encryption Grid</h3>
                <div id="encryptGrid"></div>
            </div>
        </div>
        
        <div class="panel">
            <h2>Decryption</h2>
            <label for="ciphertext">Ciphertext:</label>
            <textarea id="ciphertext" placeholder="Enter text to decrypt"></textarea>
            
            <label for="decryptionKey">Decryption Key:</label>
            <input type="text" id="decryptionKey" placeholder="Enter decryption key">
            
            <label for="decryptGridSize">Grid Size (N x N):</label>
            <input type="number" id="decryptGridSize" min="2" max="20" value="5">
            
            <button id="decryptBtn">Decrypt</button>
            <div id="decryptStatus" class="status"></div>
            
            <div class="grid-visualization">
                <h3>Decryption Grid</h3>
                <div id="decryptGrid"></div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Create workers
            const encryptWorker = new Worker('encryptWorker.js');
            const decryptWorker = new Worker('decryptWorker.js');
            
            // Encryption handler
            document.getElementById('encryptBtn').addEventListener('click', function() {
                const plaintext = document.getElementById('plaintext').value;
                const key = document.getElementById('encryptionKey').value;
                const gridSize = parseInt(document.getElementById('gridSize').value);
                
                if (!plaintext || !key) {
                    showStatus('encryptStatus', 'Please enter both text and key', 'error');
                    return;
                }
                
                encryptWorker.postMessage({
                    plaintext: plaintext,
                    key: key,
                    gridSize: gridSize
                });
            });
            
            // Decryption handler
            document.getElementById('decryptBtn').addEventListener('click', function() {
                const ciphertext = document.getElementById('ciphertext').value;
                const key = document.getElementById('decryptionKey').value;
                const gridSize = parseInt(document.getElementById('decryptGridSize').value);
                
                if (!ciphertext || !key) {
                    showStatus('decryptStatus', 'Please enter both text and key', 'error');
                    return;
                }
                
                decryptWorker.postMessage({
                    ciphertext: ciphertext,
                    key: key,
                    gridSize: gridSize
                });
            });
            
            // Worker message handlers
            encryptWorker.onmessage = function(e) {
                if (e.data.error) {
                    showStatus('encryptStatus', e.data.error, 'error');
                } else {
                    document.getElementById('ciphertext').value = e.data.ciphertext;
                    showStatus('encryptStatus', 'Encryption successful!', 'success');
                    renderGrid('encryptGrid', e.data.grid, e.data.path);
                }
            };
            
            decryptWorker.onmessage = function(e) {
                if (e.data.error) {
                    showStatus('decryptStatus', e.data.error, 'error');
                } else {
                    document.getElementById('plaintext').value = e.data.plaintext;
                    showStatus('decryptStatus', 'Decryption successful!', 'success');
                    renderGrid('decryptGrid', e.data.grid, e.data.path);
                }
            };
            
            // Helper functions
            function showStatus(elementId, message, type) {
                const element = document.getElementById(elementId);
                element.textContent = message;
                element.className = 'status ' + type;
            }
            
            function renderGrid(containerId, grid, path) {
                const container = document.getElementById(containerId);
                container.innerHTML = '';
                
                const table = document.createElement('table');
                
                for (let i = 0; i < grid.length; i++) {
                    const row = document.createElement('tr');
                    
                    for (let j = 0; j < grid[i].length; j++) {
                        const cell = document.createElement('td');
                        cell.textContent = grid[i][j] || '';
                        
                        // Highlight cells that are part of the path
                        if (path.some(coord => coord[0] === i && coord[1] === j)) {
                            cell.classList.add('highlight');
                        }
                        
                        row.appendChild(cell);
                    }
                    
                    table.appendChild(row);
                }
                
                container.appendChild(table);
            }
        });
    </script>
</body>
</html>
