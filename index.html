<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Triad-X1: Complete Cryptographic Specification</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            counter-reset: section;
        }
        h1, h2, h3, h4 {
            color: #2c3e50;
            margin-top: 24px;
        }
        h1 {
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            counter-reset: subsection;
        }
        h2 {
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
            counter-reset: subsubsection;
        }
        h2:before {
            counter-increment: section;
            content: counter(section) ". ";
        }
        h3:before {
            counter-increment: subsection;
            content: counter(section) "." counter(subsection) " ";
        }
        h4:before {
            counter-increment: subsubsection;
            content: counter(section) "." counter(subsection) "." counter(subsubsection) " ";
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .method {
            background-color: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin-bottom: 30px;
            border-radius: 0 5px 5px 0;
        }
        .math {
            font-family: "Cambria Math", serif;
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 10px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .algorithm {
            background-color: #e8f4f8;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .algorithm-title {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .security-condition {
            background-color: #fff8e1;
            padding: 10px;
            border-left: 3px solid #ffc107;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Triad-X1: Complete Cryptographic Specification</h1>
        <p><strong>Formal Definitions of All Three Methods with Full Cryptographic Operations</strong></p>
    </div>

    <div class="method">
        <h2>Hyperbolic Group Encryption (H-Cipher)</h2>
        
        <h3>Mathematical Foundation</h3>
        <div class="math">
            Let G = ‚ü®x‚ÇÅ, ..., x‚Çô | R‚ÇÅ, ..., R‚Çò‚ü© be a Œ¥-hyperbolic group with:<br>
            ‚Ä¢ Dehn function D(n) = O(n¬≤)<br>
            ‚Ä¢ Geodesic stability constant K(Œ¥)<br>
            ‚Ä¢ Asymptotic cone property: ‚àÄŒµ>0 ‚àÉN ‚àÄn‚â•N, diam(Œ≥) ‚â§ (1+Œµ)d(Œ≥(0),Œ≥(n))
        </div>
        
        <h3>Key Generation</h3>
        <div class="algorithm">
            <div class="algorithm-title">Algorithm 1.1: KeyGen(Œª) ‚Üí (K<sub>H</sub>, K'<sub>H</sub>)</div>
            <ol>
                <li>Select random reduced word w ‚àà G of length ‚Ñì(w) = Œª¬≤ + Random(Œª)</li>
                <li>Compute normal form NF(w) using Dehn's algorithm:
                    <div class="math">
                        While ‚àÉ subword u ‚äÇ w with |u| > D(Œ¥) and u = v in G:<br>
                        w ‚Üê w[u‚Üív] where |v| < |u|
                    </div>
                </li>
                <li>Verify ord(w) > 2<sup>2Œª</sup> using:
                    <div class="math">
                        Test w^p ‚â† 1 for all prime p < 2<sup>Œª</sup> (AKS primality test variant)
                    </div>
                </li>
                <li>Derive K'<sub>H</sub> = Derive(NF(w), "KeyDerivation") where:
                    <div class="math">
                        Derive(k, ctx) = NF(‚àè_{i=0}^{512} w^{SHA3-512(k‚à•ctx‚à•i)})
                    </div>
                </li>
                <li>Output (K<sub>H</sub> = NF(w), K'<sub>H</sub>)
            </ol>
        </div>
        
        <h3>Encryption Scheme</h3>
        <div class="algorithm">
            <div class="algorithm-title">Algorithm 1.2: Encrypt(m, K<sub>H</sub>) ‚Üí C</div>
            <ol>
                <li>Encode message m as group element:
                    <div class="math">
                        m<sub>G</sub> = NF(‚àè_{i=0}^{‚åà|m|/Œª‚åâ} x_{m[iŒª:(i+1)Œª] mod n})
                    </div>
                </li>
                <li>Compute ciphertext:
                    <div class="math">
                        C = NF(m<sub>G</sub> ¬∑ K<sub>H</sub><sup>-1</sup>) ¬∑ K'<sub>H</sub> mod p
                    </div>
                    where p = 2<sup>3072</sup> - 2<sup>256</sup> + 1
                </li>
                <li>Apply length normalization:
                    <div class="math">
                        C ‚Üê ShortLexReduce(C, max_len = 2Œª¬≥)
                    </div>
                </li>
            </ol>
        </div>
        
        <h3>Decryption Scheme</h3>
        <div class="algorithm">
            <div class="algorithm-title">Algorithm 1.3: Decrypt(C, K<sub>H</sub>, K'<sub>H</sub>) ‚Üí m</div>
            <ol>
                <li>Recover group element:
                    <div class="math">
                        m<sub>G</sub> = NF(NF(C ¬∑ K'<sub>H</sub><sup>-1</sup>) ¬∑ K<sub>H</sub>)
                    </div>
                </li>
                <li>Decode to binary:
                    <div class="math">
                        m = Decode(m<sub>G</sub>) where:<br>
                        Decode(g) = Concat(ExtractBits(ExponentSum(x·µ¢ in NF(g)) for i=1..n)
                    </div>
                </li>
            </ol>
        </div>
        
        <h3>Security Conditions</h3>
        <div class="security-condition">
            <strong>Theorem 1.1 (Semantic Security):</strong><br>
            If the Word Problem in G is (t,Œµ)-hard and Derive is a PRF, then for all PPT adversaries ùíú:
            <div class="math">
                Adv<sub>SS</sub>(ùíú) = |Pr[ùíú(Enc(m‚ÇÄ)) = 1] - Pr[ùíú(Enc(m‚ÇÅ)) = 1]| ‚â§ Œµ + negl(Œª)
            </div>
        </div>
    </div>

    <div class="method">
        <h2>Algebraic Variety Encryption (Singularity-X1)</h2>
        
        <h3>Variety Definition</h3>
        <div class="math">
            ùí± ‚äÇ ‚Ñô‚Åµ(ùîΩ<sub>q</sub>) defined by:<br>
            ‚éß f‚ÇÅ(x‚ÇÄ,...,x‚ÇÖ) = ‚àë_{|Œ±|=5} a‚ÇÖx^Œ± + ‚àë_{|Œ±|=3} a‚ÇÉx^Œ± = 0<br>
            ‚é® f‚ÇÇ(x‚ÇÄ,...,x‚ÇÖ) = ‚àë_{|Œ≤|=5} b‚ÇÖx^Œ≤ + ‚àë_{|Œ≤|=2} b‚ÇÇx^Œ≤ = 0<br>
            ‚é© rank(J<sub>ùí±</sub>(P)) ‚â§ 3 ‚àÄP ‚àà ùí±<br>
            where q = 2<sup>512</sup> - 569, a·µ¢,b‚±º ‚àà ùîΩ<sub>q</sub>
        </div>
        
        <h3>Key Generation</h3>
        <div class="algorithm">
            <div class="algorithm-title">Algorithm 2.1: KeyGen(Œª) ‚Üí (K<sub>S</sub>, K<sub>V</sub>)</div>
            <ol>
                <li>Generate random coefficients for f‚ÇÅ, f‚ÇÇ with:
                    <div class="math">
                        ‚àÄa·µ¢,b‚±º ‚Üê ùîΩ<sub>q</sub> s.t. ‚àÉP‚ààùí± with dim(T<sub>P</sub>ùí±) = 3
                    </div>
                </li>
                <li>Compute secret projection map:
                    <div class="math">
                        K<sub>V</sub> = [M|b] where M ‚àà GL‚ÇÉ(ùîΩ<sub>q</sub>), b ‚àà ùîΩ<sub>q</sub>¬≥
                    </div>
                </li>
                <li>Select secret point P<sub>K</sub> ‚àà ùí± with:
                    <div class="math">
                        P<sub>K</sub> = (SHA3-512(K<sub>S</sub>‚à•0), ..., SHA3-512(K<sub>S</sub>‚à•5)) mod q
                    </div>
                </li>
                <li>Output (K<sub>S</sub> = (f‚ÇÅ,f‚ÇÇ), K<sub>V</sub>)
            </ol>
        </div>
        
        <h3>Encryption Scheme</h3>
        <div class="algorithm">
            <div class="algorithm-title">Algorithm 2.2: Encrypt(m, K<sub>S</sub>, K<sub>V</sub>) ‚Üí C</div>
            <ol>
                <li>Encode message as partial point:
                    <div class="math">
                        P<sub>m</sub> = (SHA3-512(m‚à•0), SHA3-512(m‚à•1), SHA3-512(m‚à•2), ?, ?, ?)
                    </div>
                </li>
                <li>Solve for x‚ÇÉ,x‚ÇÑ,x‚ÇÖ:
                    <div class="math">
                        ‚éß f‚ÇÅ(P<sub>m</sub>) = 0<br>
                        ‚é® f‚ÇÇ(P<sub>m</sub>) = 0<br>
                        ‚é© x‚ÇÉ¬≤ + x‚ÇÑ¬≤ + x‚ÇÖ¬≤ = SHA3-512(m‚à•"norm")
                    </div>
                    using Gr√∂bner basis with F‚ÇÑ algorithm
                </li>
                <li>Apply projection:
                    <div class="math">
                        C = K<sub>V</sub> ¬∑ P<sub>m</sub> + RandomNoise(Œª)
                    </div>
                </li>
            </ol>
        </div>
        
        <h3>Decryption Scheme</h3>
        <div class="algorithm">
            <div class="algorithm-title">Algorithm 2.3: Decrypt(C, K<sub>S</sub>, K<sub>V</sub>) ‚Üí m</div>
            <ol>
                <li>Invert projection:
                    <div class="math">
                        PÃÉ = K<sub>V</sub><sup>-1</sup> ¬∑ (C - b)
                    </div>
                </li>
                <li>Recover original point:
                    <div class="math">
                        P<sub>m</sub> = argmin<sub>P‚ààùí±</sub> ||P - PÃÉ||<sub>2</sub>
                    </div>
                </li>
                <li>Extract message:
                    <div class="math">
                        m = FindPreimage(P<sub>m</sub>[0:2], SHA3-512)
                    </div>
                </li>
            </ol>
        </div>
        
        <h3>Security Conditions</h3>
        <div class="security-condition">
            <strong>Theorem 2.1 (Algebraic Security):</strong><br>
            Under the hardness of:<br>
            1) MQ problem (solving quadratic systems over ùîΩ<sub>q</sub>)<br>
            2) IP1S (Isomorphism of Polynomials with 1 Secret)<br>
            For all PPT adversaries ùíú:
            <div class="math">
                Adv<sub>IND-CPA</sub>(ùíú) ‚â§ (q<sup>-3</sup> + Œµ<sub>MQ</sub> + Œµ<sub>IP1S</sub>)¬∑poly(Œª)
            </div>
        </div>
    </div>

    <div class="method">
        <h2>Hypergraph Isomorphism (GraphLock-X1)</h2>
        
        <h3>Graph Construction</h3>
        <div class="math">
            Œì = (V,E) where:<br>
            ‚Ä¢ |V| = 3Œª<br>
            ‚Ä¢ |E| = 2Œª¬≤<br>
            ‚Ä¢ Degree distribution: Pr[deg(v) = d] = Poisson(Œª, d) for d ‚àà [Œª-5, Œª+5]<br>
            ‚Ä¢ Girth g(Œì) ‚â• log‚ÇÑ(3Œª)
        </div>
        
        <h3>Key Generation</h3>
        <div class="algorithm">
            <div class="algorithm-title">Algorithm 3.1: KeyGen(Œª) ‚Üí (Œì<sub>0</sub>, œÉ)</div>
            <ol>
                <li>Construct base graph Œì<sub>0</sub>:
                    <div class="math">
                        Œì<sub>0</sub> = RandomRegularHypergraph(3Œª, 2Œª¬≤, Œª¬±5)
                    </div>
                </li>
                <li>Generate secret isomorphism:
                    <div class="math">
                        œÉ ‚àà S<sub>3Œª</sub> with œÉ = ‚àè_{i=1}^Œª (a·µ¢ b·µ¢) (product of Œª transpositions)
                    </div>
                </li>
                <li>Compute verification tokens:
                    <div class="math">
                        ‚àÄv‚ààV: token(v) = BLAKE3(Œì<sub>0</sub>(v) ‚à• œÉ(v) ‚à• v)
                    </div>
                </li>
            </ol>
        </div>
        
        <h3>Zero-Knowledge Protocol</h3>
        <div class="algorithm">
            <div class="algorithm-title">Algorithm 3.2: ZKP-Prove(Œì<sub>0</sub>, Œì<sub>1</sub>, œÉ) ‚Üí œÄ</div>
            <ol>
                <li><strong>Commitment Phase</strong>:
                    <div class="math">
                        For i=1 to Œª:<br>
                        ‚Ä¢ Select random œÅ·µ¢ ‚àà S<sub>3Œª</sub><br>
                        ‚Ä¢ Compute ŒìÃÉ·µ¢ = œÅ·µ¢(Œì<sub>0</sub>)<br>
                        ‚Ä¢ Send h·µ¢ = BLAKE3(ŒìÃÉ·µ¢ ‚à• œÅ·µ¢)
                    </div>
                </li>
                <li><strong>Challenge Phase</strong>:
                    <div class="math">
                        Receive c ‚Üê {0,1}^Œª
                    </div>
                </li>
                <li><strong>Response Phase</strong>:
                    <div class="math">
                        For each bit c‚±º:<br>
                        If c‚±º=0: reveal œÅ‚±º<br>
                        If c‚±º=1: reveal œÑ‚±º = œÅ‚±º ‚àò œÉ<sup>-1</sup>
                    </div>
                </li>
                <li>Output œÄ = {(h·µ¢, responses)}
            </ol>
        </div>
        
        <h3>Encryption Scheme</h3>
        <div class="algorithm">
            <div class="algorithm-title">Algorithm 3.3: Encrypt(m, Œì<sub>K</sub>) ‚Üí C</div>
            <ol>
                <li>Encode message as subgraph:
                    <div class="math">
                        G<sub>m</sub> = ConstructSubgraph(m, Œì<sub>K</sub>) where:<br>
                        ‚Ä¢ Select 30% vertices V<sub>m</sub> ‚äÇ V via m-derived indices<br>
                        ‚Ä¢ Include all edges E‚à©(V<sub>m</sub>√óV<sub>m</sub>)
                    </div>
                </li>
                <li>Generate proof:
                    <div class="math">
                        œÄ = ZKP-Prove(Œì<sub>0</sub>, G<sub>m</sub>, œÉ)
                    </div>
                </li>
                <li>Output C = (G<sub>m</sub>, œÄ)
            </ol>
        </div>
        
        <h3>Decryption Scheme</h3>
        <div class="algorithm">
            <div class="algorithm-title">Algorithm 3.4: Decrypt(C, œÉ) ‚Üí m</div>
            <ol>
                <li>Verify proof:
                    <div class="math">
                        Check ZKP-Verify(œÄ, Œì<sub>0</sub>, G<sub>m</sub>)
                    </div>
                </li>
                <li>Recover message:
                    <div class="math">
                        m = Decode(œÉ<sup>-1</sup>(G<sub>m</sub>)) by:<br>
                        ‚Ä¢ Applying inverse permutation<br>
                        ‚Ä¢ Extracting vertex indices<br>
                        ‚Ä¢ Converting to binary via Gray code
                    </div>
                </li>
            </ol>
        </div>
        
        <h3>Security Conditions</h3>
        <div class="security-condition">
            <strong>Theorem 3.1 (Graph Security):</strong><br>
            Under the hardness of:<br>
            1) Hypergraph Isomorphism Problem<br>
            2) Minimum Distortion Problem for S<sub>n</sub><br>
            The scheme satisfies:
            <div class="math">
                ‚àÄPPT ùíú: Adv<sub>MIM</sub>(ùíú) ‚â§ Œª¬∑2<sup>-Œª</sup> + Œµ<sub>HI</sub> + Œµ<sub>MD</sub>
            </div>
        </div>
    </div>

    <div class="method">
        <h2>Hybrid Composition Theorem</h2>
        
        <h3>Combined Security</h3>
        <div class="security-condition">
            <strong>Theorem 4.1 (Triad Security):</strong><br>
            When composed as H-Cipher ‚àò Singularity-X1 ‚àò GraphLock-X1 with independent keys,<br>
            the system achieves:
            <div class="math">
                Adv<sub>Triad</sub>(ùíú) ‚â§ min‚éßAdv<sub>H-Cipher</sub><br>
                                      ‚é®Adv<sub>Singularity</sub><br>
                                      ‚é©Adv<sub>GraphLock</sub>
            </div>
            with failure probability Œ¥ ‚â§ 2<sup>-2Œª</sup>.
        </div>
        
        <h3>Performance Parameters</h3>
        <table>
            <tr>
                <th>Operation</th>
                <th>Time Complexity</th>
                <th>Space Complexity</th>
            </tr>
            <tr>
                <td>H-Cipher Encrypt</td>
                <td>O(Œª¬≥ log p)</td>
                <td>O(Œª¬≤)</td>
            </tr>
            <tr>
                <td>Singularity Encrypt</td>
                <td>O(Œª‚Å∂) [F‚ÇÑ complexity]</td>
                <td>O(Œª‚Å¥)</td>
            </tr>
            <tr>
                <td>GraphLock Prove</td>
                <td>O(Œª¬≥)</td>
                <td>O(Œª¬≤)</td>
            </tr>
        </table>
    </div>
</body>
</html>
